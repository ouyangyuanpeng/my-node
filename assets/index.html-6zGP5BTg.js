import{_ as i,c as a,a as n,o as e}from"./app-CbO9e9FJ.js";const l={};function t(p,s){return e(),a("div",null,s[0]||(s[0]=[n(`<h2 id="android-studio" tabindex="-1"><a class="header-anchor" href="#android-studio"><span>Android Studio</span></a></h2><h3 id="模拟器" tabindex="-1"><a class="header-anchor" href="#模拟器"><span>模拟器</span></a></h3><div class="language-bat line-numbers-mode" data-ext="bat" data-title="bat"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">//启动编译器安装的模拟器</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">// 查看安装的模拟器</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">emulator -list-avds</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">emulator -avd 模拟器名称</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">// 模拟器访问电脑服务</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">// ip不能是127.0.0.1和localhsot 需要是10.0.2.2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="签名证书" tabindex="-1"><a class="header-anchor" href="#签名证书"><span>签名证书</span></a></h2><h3 id="生成签名证书" tabindex="-1"><a class="header-anchor" href="#生成签名证书"><span>生成签名证书</span></a></h3><p>使用 keytool -genkey 命令生成证书：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">keytool</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -genkey</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -alias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> testalias</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -keyalg</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> RSA</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -keysize</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2048</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -validity</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 36500</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -keystore</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my.keystore</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>testalias 是证书别名，可修改为自己想设置的字符，建议使用英文字母和数字</li><li>my.keystore 是证书文件名称，可修改为自己想设置的文件名称，也可以指定完整文件路径</li><li>36500 是证书的有效期，表示 100 年有效期，单位天，建议时间设置长一点，避免证书过期</li></ul><p>回车后会提示：</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>Enter keystore password:  //输入证书文件密码，输入完成回车</span></span>
<span class="line"><span>Re-enter new password:   //再次输入证书文件密码，输入完成回车</span></span>
<span class="line"><span>What is your first and last name?</span></span>
<span class="line"><span>  [Unknown]:  //输入名字和姓氏，输入完成回车</span></span>
<span class="line"><span>What is the name of your organizational unit?</span></span>
<span class="line"><span>  [Unknown]:  //输入组织单位名称，输入完成回车</span></span>
<span class="line"><span>What is the name of your organization?</span></span>
<span class="line"><span>  [Unknown]:  //输入组织名称，输入完成回车</span></span>
<span class="line"><span>What is the name of your City or Locality?</span></span>
<span class="line"><span>  [Unknown]:  //输入城市或区域名称，输入完成回车</span></span>
<span class="line"><span>What is the name of your State or Province?</span></span>
<span class="line"><span>  [Unknown]:  //输入省/市/自治区名称，输入完成回车</span></span>
<span class="line"><span>What is the two-letter country code for this unit?</span></span>
<span class="line"><span>  [Unknown]:  //输入国家/地区代号（两个字母），中国为CN，输入完成回车</span></span>
<span class="line"><span>Is CN=XX, OU=XX, O=XX, L=XX, ST=XX, C=XX correct?</span></span>
<span class="line"><span>  [no]:  //确认上面输入的内容是否正确，输入y，回车</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Enter key password for &lt;testalias&gt;</span></span>
<span class="line"><span>        (RETURN if same as keystore password):  //确认证书密码与证书文件密码一样（HBuilder|HBuilderX要求这两个密码一致），直接回车就可以</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>生成的证书目录在你控制台对应目录下 <strong>注意：上述信息填写要规范，乱填有可能会影响应用上架应用市场。</strong></p><h3 id="查看证书信息" tabindex="-1"><a class="header-anchor" href="#查看证书信息"><span>查看证书信息</span></a></h3><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>keytool -list -v -keystore test.keystore</span></span>
<span class="line"><span>Enter keystore password: //输入密码，回车</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>会输出以下格式信息：</p><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>Keystore type: PKCS12</span></span>
<span class="line"><span>Keystore provider: SUN</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Your keystore contains 1 entry</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Alias name: test</span></span>
<span class="line"><span>Creation date: 2019-10-28</span></span>
<span class="line"><span>Entry type: PrivateKeyEntry</span></span>
<span class="line"><span>Certificate chain length: 1</span></span>
<span class="line"><span>Certificate[1]:</span></span>
<span class="line"><span>Owner: CN=Tester, OU=Test, O=Test, L=HD, ST=BJ, C=CN</span></span>
<span class="line"><span>Issuer: CN=Tester, OU=Test, O=Test, L=HD, ST=BJ, C=CN</span></span>
<span class="line"><span>Serial number: 7dd12840</span></span>
<span class="line"><span>Valid from: Fri Jul 26 20:52:56 CST 2019 until: Sun Jul 02 20:52:56 CST 2119</span></span>
<span class="line"><span>Certificate fingerprints:</span></span>
<span class="line"><span>         MD5:  F9:F6:C8:1F:DB:AB:50:14:7D:6F:2C:4F:CE:E6:0A:A5</span></span>
<span class="line"><span>         SHA1: BB:AC:E2:2F:97:3B:18:02:E7:D6:69:A3:7A:28:EF:D2:3F:A3:68:E7</span></span>
<span class="line"><span>         SHA256: 24:11:7D:E7:36:12:BC:FE:AF:2A:6A:24:BD:04:4F:2E:33:E5:2D:41:96:5F:50:4D:74:17:7F:4F:E2:55:EB:26</span></span>
<span class="line"><span>Signature algorithm name: SHA256withRSA</span></span>
<span class="line"><span>Subject Public Key Algorithm: 2048-bit RSA key</span></span>
<span class="line"><span>Version: 3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>其中证书指纹信息（Certificate fingerprints）：</p><ul><li>MD5<br> 证书的 MD5 指纹信息（安全码 MD5）</li><li>SHA1<br> 证书的 SHA1 指纹信息（安全码 SHA1）</li><li>SHA256<br> 证书的 SHA256 指纹信息（安全码 SHA245）</li></ul><p>转换为PKCS12 (可选)，如果转换为p12后续密钥库需要替换为p12</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">keytool</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -importkeystore</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -srckeystore</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my.keystore</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -destkeystore</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my.p12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -srcstoretype</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> JKS</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -deststoretype</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> PKCS12</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -srcstorepass</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">密钥库密</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">码</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">    -deststorepass</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">密钥库密</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">码</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>-srckeystore my1.keystore</code>：指定源密钥库（即现有的JKS文件）。</p></li><li><p><code>-destkeystore my1.p12</code>：指定目标密钥库（即将创建的PKCS12文件）。请注意，这里我们使用<code>.p12</code>作为扩展名以明确表示这是PKCS12格式。</p></li><li><p><code>-srcstoretype JKS</code>：指定源密钥库的类型为JKS。</p></li><li><p><code>-deststoretype PKCS12</code>：指定目标密钥库的类型为PKCS12。</p></li><li><p><code>-srcstorepass &lt;旧密钥库密码&gt;</code>：提供旧密钥库的密码。</p></li><li><p><code>-deststorepass &lt;新密钥库密码&gt;</code>：提供新密钥库的密码。如果希望保留相同的密码，可以使用与旧密码相同的值。</p></li></ul><h2 id="对apk进行签名" tabindex="-1"><a class="header-anchor" href="#对apk进行签名"><span>对apk进行签名</span></a></h2><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># apksigner位于Android SDK/build-tools/SDK版本/lib/下</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">java</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -jar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apksigner.jar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sign</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --ks</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my.keystore</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --ks-key-alias</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">您的keystore别</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">名</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --ks-pass</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pass:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">keystore密</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">码</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --key-pass</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pass:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">密钥密</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">码</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --v1-signing-enabled</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --v2-signing-enabled</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --v3-signing-enabled</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my-release-signed.apk</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my-release-unsigned.apk</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>--out 输出签名后的文件</p></li><li><p>--ks 密钥库</p></li><li><p>--ks-key-alias 密钥库别名</p></li><li><p>--v1-signing-enabled true 启用v1签名</p></li><li><p>--v2-signing-enabled true 启用v2签名</p></li><li><p>--v3-signing-enabled true 启用v3签名</p></li></ul><p>示例:</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">java</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -jar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apksigner.jar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sign</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --ks</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my.keystore</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --ks-key-alias</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my.keystore</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --ks-pass</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pass:82687733</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --key-pass</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pass:82687733</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --v1-signing-enabled</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --v2-signing-enabled</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --v3-signing-enabled</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --out</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my-release-signed.apk</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my-release-unsigned.apk</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>v2 v3 签名可以不用填写apksigner会自动进行</p><p>验证签名是否成功：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">java</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -jar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apksigner.jar</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> verify</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --verbose</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> my-release-signed.apk</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>`,28)]))}const r=i(l,[["render",t],["__file","index.html.vue"]]),h=JSON.parse('{"path":"/%E6%8A%80%E6%9C%AF%E6%A0%88/s8mt3dcq/","title":"安卓模拟器和签名证书","lang":"zh-CN","frontmatter":{"title":"安卓模拟器和签名证书","createTime":"2024/11/14 10:21:26","permalink":"/技术栈/s8mt3dcq/"},"headers":[],"readingTime":{"minutes":3.81,"words":1144},"git":{"updatedTime":1736151611000,"contributors":[{"name":"oyyp","email":"513150165@qq.com","commits":3,"avatar":"https://avatars.githubusercontent.com/oyyp?v=4","url":"https://github.com/oyyp"}]},"filePathRelative":"notes/技术栈/Android/安卓模拟器和签名证书.md","categoryList":[{"id":"4358b5","sort":10000,"name":"notes"},{"id":"659f61","sort":10003,"name":"技术栈"},{"id":"fa5c74","sort":10013,"name":"Android"}],"bulletin":false}');export{r as comp,h as data};
